<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Krazy Cravings</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
        <link rel="stylesheet" type="text/css" href="product.css">
        <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
        <script src="../../Assets/js/js.min.js"></script> <!--slider-->
        <link rel="stylesheet" href="../../Assets/css/style.min.css"> <!--slider-->
	
    </head>

    <body>
    <div data-role="page" id="homeUser" >
        <div data-role="header" data-position="fixed" data-tap-toggle="false" id="header">

            <div class="mhead">
                <a class="back-btn" href="../Vendor">
                    < Back</a>
                <img class="menu-ham2" src="../../Assets/img/rectangle_logo_black.png">
            </div>
            <!-- /grid-b -->
        </div>
        <div data-role="content" align="center">
            <img class="productImage" id="customProductImage" src="" />
            <div id="container3">
                <div id="p-name"></div>
                <div id="input_div">
                    <img src="../../Assets/img/icons/add-button.svg" class="plus-product" height="25" width="25" onclick="addFunction()" >
                    <input type="number" name="number" id="quantity" value="1" data-role=none disabled/>
                    <img src="../../Assets/img/icons/remove.svg" class="minus-product" onclick="removeFunction()" height="25" width="25">
                </div>
                <div id="p-amount">750</div>

                <div id="p-head"><p> Size </p></div>
                <div class="ui-grid-b" id="selection2">
                    <div class="ui-block-a" id="select2-block1"><input type="radio" name="radio-choice" id="size1" checked="checked" value="750" onclick="radioUpdates()"> </div>
                    <div class="ui-block-b" id="select2-block2">Small</div>
                    <div class="ui-block-c" id="select2-block3">Rs.750</div>
                    <div class="ui-block-a" id="select2-block1"><input type="radio" name="radio-choice" id="size2" value="1390" onclick="radioUpdates()"> </div>
                    <div class="ui-block-b" id="select2-block2">Medium</div>
                    <div class="ui-block-c" id="select2-block3">Rs.1390</div>
                    <div class="ui-block-a" id="select2-block1"><input type="radio" name="radio-choice" id="size3" value="1970" onclick="radioUpdates()"> </div>
                    <div class="ui-block-b" id="select2-block2">Large</div>
                    <div class="ui-block-c" id="select2-block3">Rs.1970</div>
                </div>
                <div align="center">
                    <a  href=""  data-role="button" class="add-cart" id="add-cart" onclick="addtocart()">Add To Cart</a>
                    <br>
                </div>
            </div>

        </div>
    </div>
    </body>
    <script>

        var selectedProduct;
        var singlePrice;

        $(document).ready(function() {
            var products = localStorage.getItem('resItemList');
            products = JSON.parse(products);

            products.forEach(item => {
                if(item.id == localStorage.getItem("directingTo")){
                    selectedProduct = item 
                }
            });
            
            document.getElementById("p-name").innerHTML = `<strong>${selectedProduct.name}</strong>`
            document.getElementById("customProductImage").src = selectedProduct.imageurl;
            radioUpdates()
        });

        function radioUpdates(){
            var sizes = document.getElementsByName("radio-choice");
            sizes.forEach(element => {
                if(element.checked){
                    singlePrice = element.value
                }
            });

            var n = $(".plus-product").parent("#input_div").find("#quantity");
            document.getElementById("p-amount").innerHTML = Number(n.val())* Number(singlePrice);
        }

        function addFunction(){
                var n = $(".plus-product").parent("#input_div").find("#quantity");
                n.val(Number(n.val()) + 1);
                document.getElementById("p-amount").innerHTML = Number(n.val())* Number(singlePrice);
        }

        function removeFunction(){
                var n = $(".minus-product").parent("#input_div").find("#quantity");
                if ( Number(n.val()) > 1) {
                    n.val( Number(n.val()) - 1 );
                }
                document.getElementById("p-amount").innerHTML = Number(n.val())* Number(singlePrice);
        }

        function addtocart(){
            let cartItems = localStorage.getItem("cartItems");
            cartItems = (cartItems) ? JSON.parse(cartItems) : [];

            var obj = {};
            var id;        
            cartItems.length > 0 ? id = cartItems[cartItems.length-1].id + 1 : id = 0;

            obj.id = id;
            obj.itemId = selectedProduct.id;
            obj.itemName = selectedProduct.name;
            obj.itemImageurl = selectedProduct.imageurl;
            obj.quantity = $("#quantity").val();
            obj.price = singlePrice;
            cartItems.push(obj);
            localStorage.setItem("cartItems", JSON.stringify(cartItems));

            window.location.href = "../Cart/";
        }
    </script>

</html>	
